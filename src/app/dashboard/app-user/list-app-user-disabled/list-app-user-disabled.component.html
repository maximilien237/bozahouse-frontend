<html class="bg-secondary" xmlns="http://www.w3.org/1999/html">

<body class="bg-secondary">

<app-header></app-header>


<div  *ngIf="isAdmin" class="container mt-lg-5 spacer-bottom text-center">


  <div class="card bg-secondary border-0">
    <div class="row">
      <!-- list users -->
      <div class="container col-md-5  mt-3" >
        <ng-container *ngIf="users | async as listUsers; else failureOrLoading">
          <div class="card spacer-top bg-dark">
            <div class=" text-secondary mt-2"><span style="font-size: 20px; font-weight: bold">[ {{appUserSizeDisabled}} ] &nbsp;Les utilisateurs désacivés &nbsp;<a *ngIf="isAdmin" routerLink="/addUser" class="btn btn-outline-secondary">
              <i class="bi bi-plus-circle"></i>
            </a></span></div>
            <div class="card-body">

              <ng-container  *ngIf="searchFormGroup">
                <form [formGroup]="searchFormGroup" (ngSubmit)="handleSearchAppUsersDisabledByUsername()">
                  <div class="input-group">
                    <label class="form-label">Keyword :</label>
                    <input type="text" formControlName = "keyword" class="form-control">
                    <button class="btn btn-warning"><i class="bi bi-search"></i> </button>
                  </div>
                </form>
              </ng-container>


              <table class="table mt-4 table-responsive">
                <thead class="text-center text-light">
                <tr>
                  <th>Pseudo</th>
                  <th>Activitée</th>
                  <th *ngIf="isAdmin">Actions</th>


                </tr>
                </thead>

                <tbody>
                <tr class="text-light" *ngFor="let user of users | async">

                  <td>
                    {{user.username}} <br />
                    <p *ngIf="user.account == 'employer'" style="font-size: 16px; color: lightseagreen">&nbsp;[Par]</p>
                    <p *ngIf="user.account == 'enterprise'" style="font-size: 16px; color: lightseagreen">&nbsp;[Ent]</p>
                    <p *ngIf="user.account == 'talent'" style="font-size: 16px; color: lightseagreen">&nbsp;[Tal]</p>
                  </td>

                  <td>
                    <div class="card-body" >
                      <p > <button (click)="handleListAppUserSubscription(user.id)" class="btn btn-secondary">Abonnements</button> <span *ngIf="isAdmin">|</span>
                        <a *ngIf="isAdmin" (click)="handleAppUserDates(user.id)" class="btn btn-warning">
                          <i class="bi bi-calendar"></i>
                        </a></p>
                      <p *ngIf="isAdmin"  >
                        <button (click)="handleListAppUserOffer(user.id)" class="btn btn-secondary">Offres</button> |
                        <button (click)="handleListAppUserTalent(user.id)" class="btn btn-secondary">Talents </button></p>
                    </div>
                  </td>


                  <td>

                    <p *ngIf="isAdmin">
                      <a (click)="handleDetailAppUser(user.id)" class="btn btn-outline-secondary">
                        <i class="bi bi-eye"></i>
                      </a>  <br>

                      <a (click)="handleUpdateAppUser(user.id)" class="btn btn-outline-warning">
                        <i class="bi bi-pencil"></i>
                      </a> <br>

                      <a (click)="handleEnableAppUser(user)" class="btn btn-outline-secondary">
                        <i class="bi bi-arrow-up"></i>
                      </a><br>

                      <a (click)="handleDeleteUser(user)" class="btn btn-outline-danger">
                        <i class="bi bi-trash"></i>
                      </a>

                    </p>


                  </td>

                </tr>
                </tbody>

              </table>


              <ul class=" nav nav-pills spacer-left">
                <ng-container *ngIf="currentPage > 0">
                  <li >
                    <a class="page-link btn ms-1" (click)="goToPage(currentPage - 1)" aria-label="Previous">
                      <span aria-hidden="true">&laquo;</span>
                    </a>
                  </li>
                </ng-container>

                <!-- "[A-Za-z0-9.%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{3,4}" -->

                <li *ngFor="let item of [].constructor(totalPages); let page = index" >
                  <a [ngClass]="page==currentPage?'btn-warning':'btn-outline-warning'" (click)="goToPage(page)" class="btn ms-1"  >{{page}}</a>
                </li>
                <ng-container *ngIf="currentPage < totalPages - 1">
                  <li >
                    <a class="page-link btn ms-1" (click)="goToPage(currentPage + 1)" aria-label="Next">
                      <span aria-hidden="true">&raquo;</span>
                    </a>
                  </li>
                </ng-container>

              </ul>


            </div>
          </div>
        </ng-container>

        <ng-template #failureOrLoading>

          <ng-container *ngIf="errorMessage; else loading">
            <div class="text-warning text-center spacer-margin">
              <span>Oups ! une erreur est survenue</span>

            </div>

            <div class="spacer-bottom text-center spacer-top" >
              <span><a class="btn btn-dark text-warning" (click)="goToPreviousPage()"> Retour</a> </span>
            </div>
          </ng-container>

          <ng-template #loading>

            <div class="d-flex justify-content-center spacer-margin" >
              <div class=" spinner-border text-warning" style="width: 3rem; height: 3rem;" role="status">
                <span class="visually-hidden">Loading...</span>
              </div>
            </div>
          </ng-template>

        </ng-template>
      </div>

    </div>
  </div>
</div>
<div class="mb-lg-5"></div>

<app-footer></app-footer>


</body>
</html>





